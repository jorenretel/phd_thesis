
(Semi-) Automatic Assignment of Solid-State NMR spectra
=======================================================

Over the years a lot of different sequential assignment algorithms have been written. This is completely understandable since this is a completely deterministic problem, the kind computers are actually very good at solving. However, a lot of these scripts suffer from limitations that made them unsuitable to use in my project. None of the methods was able to correctly deal with 2- and 1,3-glycerol labeled samples, for instance. A more general problem is that most algorithms are implemented as stand-alone applications. This often invokes a complicated work-flow in which one has to export several peak and resonance lists from the program that is used to do the analysis of the NMR spectra and convert them to the format expected by the routine. Afterwards the results should be imported back into the analysis program so the result can be analyzed. This is not necessarily bad if it has to be done only be done once. However, for complex assignment projects, with a work-flow in which new data and assignments are added incrementally, this becomes cumbersome. Ironically, often these programs do not get used either for the less complicated assignment tasks since the expected payoff is lower for the user when the assignment can also be done by hand in a reasonable amount of time. Installing the program, converting a hand full of text files and having to check the results afterwards in a not so straight-forward way might be enough to scare off users that would potentially have gotten perfect results using an automatic assignment algorithm.

Also the type of data these stand-alone applications output is somewhat problematic. Often this is one possible sequential assignment that is the true one according to the program. In other words, there is little space for human interference. It would be great however to be able to compare the alternative assignments that the algorithm had to consider and cherry-pick the results for those assignments you actually believe are correct. Many of these problems can be easily overcome when the (semi-) automatic assignment algorithm is integrated within the analysis program. CCPN Analysis databases a lot of information that is relevant to an automatic assignment routine, that would often be lost in a export-import routine. The program has a great Application Programming Interface (API) that gives access to all information stored in the project by the user.

It was not the initial goal to write an assignment algorithm, but more to create a tool that would help compare alternative assignment possibilities in a fast way. Because of the extensive use of different labeling schemes used in the assignment of OmpG the peaks that sequentially connect spin systems are often spread over a large amount of spectra. Therefor I needed a tool that would show me which peaks are expected in all differently labeled experiments for two sequential residues A and B. Furthermore the tool should then use the resonance information from all combinations of spin systems A' and B' with a residue type assignment that matches the types of residues A and B to cross check whether there are indeed peaks in the peak lists at the expected positions. The general idea is that the more peaks present, the higher the likelihood that these two spin systems are indeed sequentially connected. The only method I could use before, was to plot rulers on the spectra at the resonance frequencies of the nuclei within a pair of spin systems A' and B'. Then the intersections of those rulers could be used to check whether there were the expected crosspeaks in different spectra. Of course this was too slow to systematically try out all combinations of spin systems over the whole sequence. Also, when this does not immediately result in a sequential assignment it is hard to remember or write down which combinations of spin systems fit together sequentially and to which extend. Therefor information can basically be lost and work has to be redone.

Of course, an application that compares different assignment possibilities for two sequential residues can easily be abstracted to the whole sequence.




![The expected peaks can be matched to picked peaks in the spectra. Therefor the chemical shifts of all combinations of spin systems A', B' that can be assigned to sequential residues A and B can be used to predict the location of the peaks (A). How well the real fits the predicted peak location is scored by a flat bottom scoring function (B).](figures/malandro_peak_matching.svg){#fig:malandro_peak_matching}




![Flow diagram of the (semi-) automatic assignment algorithm.](figures/malandro_flow_diagram.svg){#fig:malandro_flow_diagram}